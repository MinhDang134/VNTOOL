2025-05-13 14:12:48,317 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 14:12:48,317 - root - INFO - wipo.crawl_wipo_by_name:119 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 14:12:48,345 - root - INFO - wipo.crawl_wipo_by_name:135 - WIPO Crawler: Simulating user search for: RONALDO
2025-05-13 14:12:49,666 - root - INFO - wipo.crawl_wipo_by_name:152 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 14:13:08,105 - root - INFO - wipo.crawl_wipo_by_name:166 - WIPO Crawler: User has indicated search is complete. Proceeding to fetch HTML.
2025-05-13 14:13:08,105 - root - INFO - wipo.crawl_wipo_by_name:172 - WIPO Crawler: Waiting up to 60s for search results (selector: 'li.result-viewed')...
2025-05-13 14:14:08,363 - root - ERROR - wipo.crawl_wipo_by_name:187 - WIPO Crawler: Timeout waiting for search results for 'RONALDO'. The page might not have loaded correctly or no results found with the selector.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 174, in crawl_wipo_by_name
    WebDriverWait(driver, wait_time_for_results).until(
  File "/home/minhdangpy134/DuAnWipoVNmark/.crawl_env/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 

2025-05-13 14:14:08,441 - root - INFO - wipo.crawl_wipo_by_name:202 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 14:14:08,441 - root - WARNING - wipo.crawl_wipo_by_name:207 - WIPO Crawler: No HTML content was retrieved for 'RONALDO'. Aborting further processing for this name.
2025-05-13 14:14:08,441 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 14:14:08,441 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 14:23:55,428 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 14:23:55,428 - root - INFO - wipo.crawl_wipo_by_name:126 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 14:23:55,449 - root - INFO - wipo.crawl_wipo_by_name:142 - WIPO Crawler: Simulating user search for: RONALDO
2025-05-13 14:23:56,681 - root - INFO - wipo.crawl_wipo_by_name:159 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 14:24:15,946 - root - INFO - wipo.crawl_wipo_by_name:173 - WIPO Crawler: User has indicated search is complete. Proceeding to fetch HTML.
2025-05-13 14:24:30,946 - root - INFO - wipo.crawl_wipo_by_name:179 - WIPO Crawler: Waiting up to 120s for search results (selector: 'li.result-viewed')...
2025-05-13 14:26:31,302 - root - ERROR - wipo.crawl_wipo_by_name:194 - WIPO Crawler: Timeout waiting for search results for 'RONALDO'. The page might not have loaded correctly or no results found with the selector.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 181, in crawl_wipo_by_name
    WebDriverWait(driver, wait_time_for_results).until(
  File "/home/minhdangpy134/DuAnWipoVNmark/.crawl_env/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 

2025-05-13 14:26:31,376 - root - INFO - wipo.crawl_wipo_by_name:209 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 14:26:31,376 - root - WARNING - wipo.crawl_wipo_by_name:214 - WIPO Crawler: No HTML content was retrieved for 'RONALDO'. Aborting further processing for this name.
2025-05-13 14:26:31,376 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 14:26:31,377 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 14:34:43,898 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 14:34:43,898 - root - INFO - wipo.crawl_wipo_by_name:126 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 14:34:43,920 - root - INFO - wipo.crawl_wipo_by_name:142 - WIPO Crawler: Simulating user search for: RONALDO
2025-05-13 14:34:45,170 - root - INFO - wipo.crawl_wipo_by_name:159 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 14:35:06,864 - root - INFO - wipo.crawl_wipo_by_name:173 - WIPO Crawler: User has indicated search is complete. Proceeding to fetch HTML.
2025-05-13 14:35:21,865 - root - INFO - wipo.crawl_wipo_by_name:179 - WIPO Crawler: Waiting up to 120s for search results (selector: 'li.result-viewed')...
2025-05-13 14:37:21,965 - root - ERROR - wipo.crawl_wipo_by_name:194 - WIPO Crawler: Timeout waiting for search results for 'RONALDO'. The page might not have loaded correctly or no results found with the selector.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 181, in crawl_wipo_by_name
    WebDriverWait(driver, wait_time_for_results).until(
  File "/home/minhdangpy134/DuAnWipoVNmark/.crawl_env/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 

2025-05-13 14:37:22,039 - root - INFO - wipo.crawl_wipo_by_name:209 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 14:37:22,039 - root - WARNING - wipo.crawl_wipo_by_name:214 - WIPO Crawler: No HTML content was retrieved for 'RONALDO'. Aborting further processing for this name.
2025-05-13 14:37:22,039 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 14:37:22,039 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 14:45:45,767 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 14:45:45,767 - root - INFO - wipo.crawl_wipo_by_name:126 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 14:45:45,785 - root - INFO - wipo.crawl_wipo_by_name:142 - WIPO Crawler: Simulating user search for: RONALDO
2025-05-13 14:45:47,006 - root - INFO - wipo.crawl_wipo_by_name:159 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 14:46:29,419 - root - INFO - wipo.crawl_wipo_by_name:173 - WIPO Crawler: User has indicated search is complete. Proceeding to fetch HTML.
2025-05-13 14:46:44,420 - root - INFO - wipo.crawl_wipo_by_name:179 - WIPO Crawler: Waiting up to 120s for search results (selector: 'li.result-viewed')...
2025-05-13 14:48:44,426 - root - ERROR - wipo.crawl_wipo_by_name:194 - WIPO Crawler: Timeout waiting for search results for 'RONALDO'. The page might not have loaded correctly or no results found with the selector.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 181, in crawl_wipo_by_name
    WebDriverWait(driver, wait_time_for_results).until(
  File "/home/minhdangpy134/DuAnWipoVNmark/.crawl_env/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 

2025-05-13 14:48:44,499 - root - INFO - wipo.crawl_wipo_by_name:209 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 14:48:44,499 - root - WARNING - wipo.crawl_wipo_by_name:214 - WIPO Crawler: No HTML content was retrieved for 'RONALDO'. Aborting further processing for this name.
2025-05-13 14:48:44,499 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 14:48:44,500 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 14:51:04,386 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 14:51:04,387 - root - INFO - wipo.crawl_wipo_by_name:126 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 14:51:04,409 - root - INFO - wipo.crawl_wipo_by_name:142 - WIPO Crawler: Simulating user search for: RONALDO
2025-05-13 14:51:05,618 - root - INFO - wipo.crawl_wipo_by_name:159 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 14:51:21,303 - root - INFO - wipo.crawl_wipo_by_name:173 - WIPO Crawler: User has indicated search is complete. Proceeding to fetch HTML.
2025-05-13 14:51:36,304 - root - INFO - wipo.crawl_wipo_by_name:179 - WIPO Crawler: Waiting up to 120s for search results (selector: 'li.result-viewed')...
2025-05-13 14:53:36,377 - root - ERROR - wipo.crawl_wipo_by_name:194 - WIPO Crawler: Timeout waiting for search results for 'RONALDO'. The page might not have loaded correctly or no results found with the selector.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 181, in crawl_wipo_by_name
    WebDriverWait(driver, wait_time_for_results).until(
  File "/home/minhdangpy134/DuAnWipoVNmark/.crawl_env/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 

2025-05-13 14:53:36,450 - root - INFO - wipo.crawl_wipo_by_name:209 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 14:53:36,450 - root - WARNING - wipo.crawl_wipo_by_name:214 - WIPO Crawler: No HTML content was retrieved for 'RONALDO'. Aborting further processing for this name.
2025-05-13 14:53:36,450 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 14:53:36,450 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:00:58,507 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:00:58,507 - root - INFO - wipo.crawl_wipo_by_name:320 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:01:01,747 - root - INFO - wipo.crawl_wipo_by_name:350 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:01:39,071 - root - INFO - wipo.crawl_wipo_by_name:369 - WIPO Crawler: Using dynamic timeout of 30 seconds
2025-05-13 15:02:09,418 - root - ERROR - wipo.crawl_wipo_by_name:380 - WIPO Crawler: Timeout waiting for search results for 'RONALDO'
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 372, in crawl_wipo_by_name
    WebDriverWait(driver, timeout).until(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 

2025-05-13 15:02:09,490 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:02:09,490 - root - WARNING - wipo.wrapper:290 - Function crawl_wipo_by_name failed, retrying in 1 seconds... Error: Message: 

2025-05-13 15:02:10,490 - root - INFO - wipo.crawl_wipo_by_name:320 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:02:10,498 - root - ERROR - wipo.crawl_wipo_by_name:386 - WIPO Crawler: Unexpected error: Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 337, in crawl_wipo_by_name
    ConcreteBrandModel = get_brand_model(table_name_for_brand)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/database/models.py", line 19, in get_brand_model
    BrandClass = type(class_name, (Base,), {
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_api.py", line 198, in __init__
    _as_declarative(reg, cls, dict_)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 244, in _as_declarative
    return _MapperConfig.setup_mapping(registry, cls, dict_, None, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 325, in setup_mapping
    return _ClassScanMapperConfig(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 576, in __init__
    self._setup_table(table)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 1757, in _setup_table
    table_cls(
  File "<string>", line 2, in __new__
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/util/deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 430, in __new__
    return cls._new(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 462, in _new
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
2025-05-13 15:02:10,500 - root - WARNING - wipo.wrapper:290 - Function crawl_wipo_by_name failed, retrying in 2 seconds... Error: Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
2025-05-13 15:02:12,500 - root - INFO - wipo.crawl_wipo_by_name:320 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:02:12,517 - root - ERROR - wipo.crawl_wipo_by_name:386 - WIPO Crawler: Unexpected error: Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 337, in crawl_wipo_by_name
    ConcreteBrandModel = get_brand_model(table_name_for_brand)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/database/models.py", line 19, in get_brand_model
    BrandClass = type(class_name, (Base,), {
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_api.py", line 198, in __init__
    _as_declarative(reg, cls, dict_)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 244, in _as_declarative
    return _MapperConfig.setup_mapping(registry, cls, dict_, None, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 325, in setup_mapping
    return _ClassScanMapperConfig(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 576, in __init__
    self._setup_table(table)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 1757, in _setup_table
    table_cls(
  File "<string>", line 2, in __new__
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/util/deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 430, in __new__
    return cls._new(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 462, in _new
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
2025-05-13 15:02:12,517 - root - ERROR - wipo.wrapper:287 - Function crawl_wipo_by_name failed after 3 retries: Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
2025-05-13 15:02:12,517 - __main__ - CRITICAL - test_manual.<module>:51 - An unhandled error occurred in main execution for 'RONALDO': Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/test_manual.py", line 47, in <module>
    crawl_wipo_by_name(brand_to_search)
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 283, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 337, in crawl_wipo_by_name
    ConcreteBrandModel = get_brand_model(table_name_for_brand)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/database/models.py", line 19, in get_brand_model
    BrandClass = type(class_name, (Base,), {
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_api.py", line 198, in __init__
    _as_declarative(reg, cls, dict_)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 244, in _as_declarative
    return _MapperConfig.setup_mapping(registry, cls, dict_, None, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 325, in setup_mapping
    return _ClassScanMapperConfig(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 576, in __init__
    self._setup_table(table)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py", line 1757, in _setup_table
    table_cls(
  File "<string>", line 2, in __new__
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/util/deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 430, in __new__
    return cls._new(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 462, in _new
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Table 'brand_manual' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
2025-05-13 15:02:12,518 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:04:01,156 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:04:01,156 - root - INFO - wipo.crawl_wipo_by_name:320 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:04:02,479 - root - INFO - wipo.crawl_wipo_by_name:350 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:04:18,889 - root - INFO - wipo.crawl_wipo_by_name:369 - WIPO Crawler: Using dynamic timeout of 30 seconds
2025-05-13 15:04:49,125 - root - ERROR - wipo.crawl_wipo_by_name:380 - WIPO Crawler: Timeout waiting for search results for 'RONALDO'
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 372, in crawl_wipo_by_name
    WebDriverWait(driver, timeout).until(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 

2025-05-13 15:04:49,200 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:04:49,201 - root - WARNING - wipo.wrapper:290 - Function crawl_wipo_by_name failed, retrying in 1 seconds... Error: Message: 

2025-05-13 15:04:50,201 - root - INFO - wipo.crawl_wipo_by_name:320 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:04:51,772 - root - INFO - wipo.crawl_wipo_by_name:350 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:05:57,780 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(104, 'Connection reset by peer')': /session/7f16086a4871feab0987a176fcc89f6f
2025-05-13 15:05:57,781 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x6ffd6ad606e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/7f16086a4871feab0987a176fcc89f6f
2025-05-13 15:05:57,781 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x6ffd6ad60980>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/7f16086a4871feab0987a176fcc89f6f
2025-05-13 15:05:57,781 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:05:57,781 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:06:05,883 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:06:05,883 - root - INFO - wipo.crawl_wipo_by_name:335 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:06:07,294 - root - INFO - wipo.crawl_wipo_by_name:365 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:06:24,537 - root - WARNING - wipo.check_no_results:321 - Error checking no results: Message: invalid selector: An invalid or illegal selector was specified
  (Session info: chrome=135.0.7049.114); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception
Stacktrace:
#0 0x647ba3fa275a <unknown>
#1 0x647ba3a554b0 <unknown>
#2 0x647ba3a5c0b6 <unknown>
#3 0x647ba3a5e928 <unknown>
#4 0x647ba3a5e9b3 <unknown>
#5 0x647ba3aa63e5 <unknown>
#6 0x647ba3aa6ba1 <unknown>
#7 0x647ba3af51f4 <unknown>
#8 0x647ba3acc5bd <unknown>
#9 0x647ba3af25e0 <unknown>
#10 0x647ba3acc363 <unknown>
#11 0x647ba3a98d63 <unknown>
#12 0x647ba3a999c1 <unknown>
#13 0x647ba3f67a6b <unknown>
#14 0x647ba3f6b951 <unknown>
#15 0x647ba3f4fb62 <unknown>
#16 0x647ba3f6c4c4 <unknown>
#17 0x647ba3f3413f <unknown>
#18 0x647ba3f906f8 <unknown>
#19 0x647ba3f908d6 <unknown>
#20 0x647ba3fa15a6 <unknown>
#21 0x77d05309caa4 <unknown>
#22 0x77d053129c3c <unknown>

2025-05-13 15:06:24,540 - root - INFO - wipo.crawl_wipo_by_name:384 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 15:09:10,683 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(104, 'Connection reset by peer')': /session/2e900618bb711a7f84c8b6602abaec30
2025-05-13 15:09:10,683 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x768544b83c20>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/2e900618bb711a7f84c8b6602abaec30
2025-05-13 15:09:10,684 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x768544b83890>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/2e900618bb711a7f84c8b6602abaec30
2025-05-13 15:09:10,684 - root - INFO - wipo.crawl_wipo_by_name:428 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:09:10,684 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:09:12,267 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:09:12,267 - root - INFO - wipo.crawl_wipo_by_name:362 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:09:13,646 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:09:27,260 - root - INFO - wipo.crawl_wipo_by_name:411 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 15:13:18,864 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(104, 'Connection reset by peer')': /session/46c9f4477226d561028b825b2605a5a3
2025-05-13 15:13:18,864 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70370a97f770>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/46c9f4477226d561028b825b2605a5a3
2025-05-13 15:13:18,865 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70370a97fb00>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/46c9f4477226d561028b825b2605a5a3
2025-05-13 15:13:18,865 - root - INFO - wipo.crawl_wipo_by_name:455 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:13:18,865 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:13:20,707 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:13:20,707 - root - INFO - wipo.crawl_wipo_by_name:362 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:13:22,054 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:13:39,886 - root - INFO - wipo.crawl_wipo_by_name:419 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 15:15:58,031 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(104, 'Connection reset by peer')': /session/8920520b9ba984e2de8d0a7bdc7c75d1
2025-05-13 15:15:58,031 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7eb9764f3920>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8920520b9ba984e2de8d0a7bdc7c75d1
2025-05-13 15:15:58,031 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7eb9764f3a10>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8920520b9ba984e2de8d0a7bdc7c75d1
2025-05-13 15:15:58,032 - root - INFO - wipo.crawl_wipo_by_name:501 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:15:58,032 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:17:11,552 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:17:11,552 - root - INFO - wipo.crawl_wipo_by_name:362 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:17:13,066 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:17:27,538 - root - WARNING - wipo.crawl_wipo_by_name:415 - WIPO Crawler: Not on search results page. Current URL: https://branddb.wipo.int/en/similarname/results?sort=score%20desc&start=0&rows=30&asStructure=%7B%22_id%22:%22d04a%22,%22boolean%22:%22AND%22,%22bricks%22:%5B%7B%22_id%22:%22d04b%22,%22key%22:%22brandName%22,%22value%22:%22RONALDO%22,%22strategy%22:%22Simple%22%7D%5D%7D&_=1747124237685&fg=_void_
2025-05-13 15:17:27,615 - root - INFO - wipo.crawl_wipo_by_name:511 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:17:27,615 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:17:27,615 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:20:11,291 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:20:11,291 - root - INFO - wipo.crawl_wipo_by_name:362 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:20:12,654 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:20:24,498 - root - INFO - wipo.crawl_wipo_by_name:425 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 15:20:45,114 - root - INFO - wipo.crawl_wipo_by_name:464 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 15:20:45,114 - root - INFO - wipo.crawl_wipo_by_name:465 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 15:20:50,198 - root - INFO - wipo.crawl_wipo_by_name:516 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:20:50,199 - root - INFO - wipo.crawl_wipo_by_name:526 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:98 - Parser: Block 0: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 0 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:98 - Parser: Block 1: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 1 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:98 - Parser: Block 2: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 2 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:98 - Parser: Block 3: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 3 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:98 - Parser: Block 4: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:20:50,213 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 4 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:20:50,213 - root - INFO - parser.parse_wipo_html:124 - Parser: Parsed 0 items from HTML.
2025-05-13 15:20:50,213 - root - INFO - wipo.crawl_wipo_by_name:530 - WIPO Crawler: No items parsed from HTML for 'RONALDO'
2025-05-13 15:20:50,214 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:20:50,214 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:24:44,078 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:24:44,078 - root - INFO - wipo.crawl_wipo_by_name:362 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:24:45,468 - root - INFO - wipo.crawl_wipo_by_name:392 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:24:57,762 - root - INFO - wipo.crawl_wipo_by_name:425 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 15:25:18,373 - root - INFO - wipo.crawl_wipo_by_name:464 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 15:25:18,373 - root - INFO - wipo.crawl_wipo_by_name:465 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 15:25:23,458 - root - INFO - wipo.crawl_wipo_by_name:516 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:25:23,458 - root - INFO - wipo.crawl_wipo_by_name:526 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 15:25:23,475 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 5: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,475 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 5 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,475 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 6: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,475 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 6 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,475 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 7: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 7 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 8: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 8 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 9: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 9 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 10: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 10 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 11: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 11 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 12: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 12 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 13: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 13 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 14: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,476 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 14 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 15: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 15 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 16: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 16 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 17: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 17 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 18: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 18 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 19: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 19 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 20: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 20 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 21: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 21 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 22: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 22 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,477 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 23: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 23 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 24: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 24 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 25: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 25 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 26: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 26 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 27: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 27 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 28: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 28 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 29: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:25:23,478 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 29 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:25:23,478 - root - INFO - parser.parse_wipo_html:124 - Parser: Parsed 5 items from HTML.
2025-05-13 15:25:23,484 - root - ERROR - wipo._save_wipo_items_to_db:140 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 812888227, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '812888227'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 128, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '812888227'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-13 15:25:23,488 - root - ERROR - wipo._save_wipo_items_to_db:140 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 545,892, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 128, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-13 15:25:23,491 - root - ERROR - wipo._save_wipo_items_to_db:140 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 544,244, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 128, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-13 15:25:23,493 - root - ERROR - wipo._save_wipo_items_to_db:140 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 145299, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '145299'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 128, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': '145299'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-13 15:25:23,495 - root - ERROR - wipo._save_wipo_items_to_db:140 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: M1935158, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 128, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column brand_manual.owner does not exist
LINE 1: ...and_manual.created_at AS brand_manual_created_at, brand_manu...
                                                             ^

[SQL: SELECT brand_manual.id AS brand_manual_id, brand_manual.name AS brand_manual_name, brand_manual.product_group AS brand_manual_product_group, brand_manual.status AS brand_manual_status, brand_manual.registration_date AS brand_manual_registration_date, brand_manual.image_url AS brand_manual_image_url, brand_manual.source AS brand_manual_source, brand_manual.created_at AS brand_manual_created_at, brand_manual.owner AS brand_manual_owner, brand_manual.original_number AS brand_manual_original_number 
FROM brand_manual 
WHERE brand_manual.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-13 15:25:23,496 - root - INFO - wipo._save_wipo_items_to_db:164 - DB Save (WIPO_Search_RONALDO): No new items were successfully processed to commit out of 5 items.
2025-05-13 15:25:23,496 - root - INFO - wipo.crawl_wipo_by_name:544 - WIPO Crawler: Successfully saved 5 items to database
2025-05-13 15:25:23,497 - root - INFO - wipo.crawl_wipo_by_name:550 - WIPO Crawler: Database session closed.
2025-05-13 15:25:23,497 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:25:23,497 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:33:56,751 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:33:56,751 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:33:56,751 - root - INFO - wipo.crawl_wipo_by_name:361 - WIPO Crawler: Using cached data for 'RONALDO'
2025-05-13 15:33:56,752 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:33:56,752 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:37:26,905 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:37:26,905 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:37:26,905 - root - INFO - wipo.crawl_wipo_by_name:361 - WIPO Crawler: Using cached data for 'RONALDO'
2025-05-13 15:37:26,905 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:37:26,905 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:41:24,120 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:41:24,120 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:41:25,491 - root - INFO - wipo.crawl_wipo_by_name:385 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:41:37,892 - root - INFO - wipo.crawl_wipo_by_name:418 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 15:41:58,332 - root - INFO - wipo.crawl_wipo_by_name:457 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 15:41:58,332 - root - INFO - wipo.crawl_wipo_by_name:458 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 15:42:03,419 - root - INFO - wipo.crawl_wipo_by_name:509 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:42:03,419 - root - INFO - wipo.crawl_wipo_by_name:519 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 15:42:03,435 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 0: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,435 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 0 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,439 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 10: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,439 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 10 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,439 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 11: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,439 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 11 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,439 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 12: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,439 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 12 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,439 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 13: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 13 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 14: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 14 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 15: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 15 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 16: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 16 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 17: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 17 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 18: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 18 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 19: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 19 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 20: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,440 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 20 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 21: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 21 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 22: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 22 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 23: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 23 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 24: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 24 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 25: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 25 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 26: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 26 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 27: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 27 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 28: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 28 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 29: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:42:03,441 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 29 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:42:03,442 - root - INFO - parser.parse_wipo_html:124 - Parser: Parsed 9 items from HTML.
2025-05-13 15:42:03,446 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 545,892, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 15:42:03,451 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 544,244, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 15:42:03,453 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: M1935158, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine.base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine.base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine.base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine.base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine.base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine.base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine.default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 15:46:04,552 - root - INFO - wipo._save_wipo_items_to_db:146 - DB Save (WIPO_Search_RONALDO): Successfully committed 2 out of 5 processed items to DB.
2025-05-13 15:46:04,552 - root - INFO - wipo.crawl_wipo_by_name:537 - WIPO Crawler: Successfully saved 5 items to database
2025-05-13 15:46:04,553 - root - INFO - wipo.crawl_wipo_by_name:543 - WIPO Crawler: Database session closed.
2025-05-13 15:46:04,553 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:46:04,553 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:49:59,656 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:49:59,656 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:50:01,039 - root - INFO - wipo.crawl_wipo_by_name:385 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 15:50:14,679 - root - INFO - wipo.crawl_wipo_by_name:418 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 15:50:35,609 - root - INFO - wipo.crawl_wipo_by_name:457 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 15:50:35,609 - root - INFO - wipo.crawl_wipo_by_name:458 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 15:50:40,695 - root - INFO - wipo.crawl_wipo_by_name:509 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 15:50:40,695 - root - INFO - wipo.crawl_wipo_by_name:519 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 15:50:40,711 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 5: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,711 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 5 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,711 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 6: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,711 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 6 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 7: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 7 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 8: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 8 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 9: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 9 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 10: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 10 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 11: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 11 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 12: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,712 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 12 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 13: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 13 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 14: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 14 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 15: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 15 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 16: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 16 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 17: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 17 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 18: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,713 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 18 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 19: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 19 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 20: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 20 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 21: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 21 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 22: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 22 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 23: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 23 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 24: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 24 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,714 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 25: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 25 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 26: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 26 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 27: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 27 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 28: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 28 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:100 - Parser: Block 29: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 15:50:40,715 - root - WARNING - parser.parse_wipo_html:109 - Parser: Skipping item for block 29 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 15:50:40,715 - root - INFO - parser.parse_wipo_html:124 - Parser: Parsed 5 items from HTML.
2025-05-13 15:50:40,730 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 545,892, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 15:50:40,734 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 544,244, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 15:50:40,737 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: M1935158, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 15:50:40,738 - root - INFO - wipo._save_wipo_items_to_db:146 - DB Save (WIPO_Search_RONALDO): Successfully committed 2 out of 5 processed items to DB.
2025-05-13 15:50:40,738 - root - INFO - wipo.crawl_wipo_by_name:537 - WIPO Crawler: Successfully saved 5 items to database
2025-05-13 15:50:40,738 - root - INFO - wipo.crawl_wipo_by_name:543 - WIPO Crawler: Database session closed.
2025-05-13 15:50:40,738 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:50:40,739 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:58:38,773 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:58:38,773 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:58:38,774 - root - INFO - wipo.crawl_wipo_by_name:361 - WIPO Crawler: Using cached data for 'RONALDO'
2025-05-13 15:58:38,774 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:58:38,774 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 15:59:19,916 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 15:59:19,916 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 15:59:19,917 - root - INFO - wipo.crawl_wipo_by_name:361 - WIPO Crawler: Using cached data for 'RONALDO'
2025-05-13 15:59:19,917 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 15:59:19,917 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 16:12:12,096 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 16:12:12,096 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 16:12:14,086 - root - INFO - wipo.crawl_wipo_by_name:385 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 16:12:25,802 - root - INFO - wipo.crawl_wipo_by_name:418 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 16:12:46,204 - root - INFO - wipo.crawl_wipo_by_name:457 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 16:12:46,204 - root - INFO - wipo.crawl_wipo_by_name:458 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 16:12:51,296 - root - INFO - wipo.crawl_wipo_by_name:509 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 16:12:51,296 - root - INFO - wipo.crawl_wipo_by_name:519 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 16:12:51,309 - root - INFO - parser.parse_wipo_html:34 - Found 30 result blocks to parse
2025-05-13 16:12:51,317 - root - WARNING - parser.parse_wipo_html:65 - Block 6: No ID found with any selector
2025-05-13 16:12:51,317 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 6: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 6 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:65 - Block 7: No ID found with any selector
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 7: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 7 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:65 - Block 8: No ID found with any selector
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 8: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 8 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:65 - Block 9: No ID found with any selector
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 9: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 9 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:65 - Block 10: No ID found with any selector
2025-05-13 16:12:51,318 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 10: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 10 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:65 - Block 11: No ID found with any selector
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 11: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 11 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:65 - Block 12: No ID found with any selector
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 12: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 12 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:65 - Block 13: No ID found with any selector
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 13: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 13 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,319 - root - WARNING - parser.parse_wipo_html:65 - Block 14: No ID found with any selector
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 14: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 14 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:65 - Block 15: No ID found with any selector
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 15: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 15 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:65 - Block 16: No ID found with any selector
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 16: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 16 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:65 - Block 17: No ID found with any selector
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 17: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 17 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,320 - root - WARNING - parser.parse_wipo_html:65 - Block 18: No ID found with any selector
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 18: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 18 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:65 - Block 19: No ID found with any selector
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 19: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 19 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:65 - Block 20: No ID found with any selector
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 20: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 20 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:65 - Block 21: No ID found with any selector
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 21: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 21 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,321 - root - WARNING - parser.parse_wipo_html:65 - Block 22: No ID found with any selector
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 22: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 22 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:65 - Block 23: No ID found with any selector
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 23: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 23 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:65 - Block 24: No ID found with any selector
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 24: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 24 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:65 - Block 25: No ID found with any selector
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 25: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 25 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,322 - root - WARNING - parser.parse_wipo_html:65 - Block 26: No ID found with any selector
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 26: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 26 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:65 - Block 27: No ID found with any selector
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 27: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 27 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:65 - Block 28: No ID found with any selector
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 28: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 28 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:65 - Block 29: No ID found with any selector
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 29: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 29 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:65 - Block 30: No ID found with any selector
2025-05-13 16:12:51,323 - root - WARNING - parser.parse_wipo_html:99 - Parser: Block 30: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:12:51,324 - root - WARNING - parser.parse_wipo_html:108 - Parser: Skipping item for block 30 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:12:51,324 - root - INFO - parser.parse_wipo_html:123 - Parser: Successfully parsed 5 items from 30 blocks.
2025-05-13 16:12:51,349 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 545,892, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "545,892"
LINE 3: WHERE trademark.id = '545,892'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '545,892'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 16:12:51,358 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: 544,244, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "544,244"
LINE 3: WHERE trademark.id = '544,244'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': '544,244'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 16:12:51,372 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: M1935158, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 16:12:51,374 - root - INFO - wipo._save_wipo_items_to_db:146 - DB Save (WIPO_Search_RONALDO): Successfully committed 2 out of 5 processed items to DB.
2025-05-13 16:12:51,374 - root - INFO - wipo.crawl_wipo_by_name:537 - WIPO Crawler: Successfully saved 5 items to database
2025-05-13 16:12:51,374 - root - INFO - wipo.crawl_wipo_by_name:543 - WIPO Crawler: Database session closed.
2025-05-13 16:12:51,374 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 16:12:51,374 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 16:18:15,279 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 16:18:15,279 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 16:18:52,691 - root - INFO - wipo.crawl_wipo_by_name:385 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 16:18:57,179 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(104, 'Connection reset by peer')': /session/93c763103074f06bf35834fca091ca3d
2025-05-13 16:18:57,180 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x756a26162990>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/93c763103074f06bf35834fca091ca3d
2025-05-13 16:18:57,181 - urllib3.connectionpool - WARNING - connectionpool.urlopen:868 - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x756a26163620>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/93c763103074f06bf35834fca091ca3d
2025-05-13 16:18:57,182 - root - INFO - wipo.crawl_wipo_by_name:509 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 16:18:57,182 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 16:19:04,028 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 16:19:04,028 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 16:19:05,363 - root - INFO - wipo.crawl_wipo_by_name:385 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 16:19:17,876 - root - INFO - wipo.crawl_wipo_by_name:418 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 16:19:38,772 - root - INFO - wipo.crawl_wipo_by_name:457 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 16:19:38,772 - root - INFO - wipo.crawl_wipo_by_name:458 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 16:19:43,865 - root - INFO - wipo.crawl_wipo_by_name:509 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 16:19:43,865 - root - INFO - wipo.crawl_wipo_by_name:519 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 16:19:43,877 - root - INFO - parser.parse_wipo_html:136 - Found 30 result blocks to parse
2025-05-13 16:19:43,878 - root - INFO - parser.extract_id_from_block:101 - Block 1: Successfully extracted ID '812888227' using selector '.number span.value'
2025-05-13 16:19:43,878 - root - INFO - parser.parse_wipo_html:158 - Block 1: Using ID '812888227' (found with selector: .number span.value)
2025-05-13 16:19:43,880 - root - INFO - parser.extract_id_from_block:101 - Block 2: Successfully extracted ID '545892' using selector '.number span.value'
2025-05-13 16:19:43,880 - root - INFO - parser.parse_wipo_html:158 - Block 2: Using ID '545892' (found with selector: .number span.value)
2025-05-13 16:19:43,881 - root - INFO - parser.extract_id_from_block:101 - Block 3: Successfully extracted ID '544244' using selector '.number span.value'
2025-05-13 16:19:43,881 - root - INFO - parser.parse_wipo_html:158 - Block 3: Using ID '544244' (found with selector: .number span.value)
2025-05-13 16:19:43,882 - root - INFO - parser.extract_id_from_block:101 - Block 4: Successfully extracted ID '145299' using selector '.number span.value'
2025-05-13 16:19:43,882 - root - INFO - parser.parse_wipo_html:158 - Block 4: Using ID '145299' (found with selector: .number span.value)
2025-05-13 16:19:43,884 - root - INFO - parser.extract_id_from_block:101 - Block 5: Successfully extracted ID 'M1935158' using selector '.number span.value'
2025-05-13 16:19:43,884 - root - INFO - parser.parse_wipo_html:158 - Block 5: Using ID 'M1935158' (found with selector: .number span.value)
2025-05-13 16:19:43,885 - root - WARNING - parser.extract_id_from_block:123 - Block 6: No ID found using any method
2025-05-13 16:19:43,885 - root - WARNING - parser.parse_wipo_html:160 - Block 6: Failed to extract ID
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 6: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 6 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,886 - root - WARNING - parser.extract_id_from_block:123 - Block 7: No ID found using any method
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:160 - Block 7: Failed to extract ID
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 7: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 7 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,886 - root - WARNING - parser.extract_id_from_block:123 - Block 8: No ID found using any method
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:160 - Block 8: Failed to extract ID
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 8: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,886 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 8 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,886 - root - WARNING - parser.extract_id_from_block:123 - Block 9: No ID found using any method
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:160 - Block 9: Failed to extract ID
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 9: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 9 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,887 - root - WARNING - parser.extract_id_from_block:123 - Block 10: No ID found using any method
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:160 - Block 10: Failed to extract ID
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 10: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 10 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,887 - root - WARNING - parser.extract_id_from_block:123 - Block 11: No ID found using any method
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:160 - Block 11: Failed to extract ID
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 11: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 11 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,887 - root - WARNING - parser.extract_id_from_block:123 - Block 12: No ID found using any method
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:160 - Block 12: Failed to extract ID
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 12: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,887 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 12 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,888 - root - WARNING - parser.extract_id_from_block:123 - Block 13: No ID found using any method
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:160 - Block 13: Failed to extract ID
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 13: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 13 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,888 - root - WARNING - parser.extract_id_from_block:123 - Block 14: No ID found using any method
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:160 - Block 14: Failed to extract ID
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 14: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 14 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,888 - root - WARNING - parser.extract_id_from_block:123 - Block 15: No ID found using any method
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:160 - Block 15: Failed to extract ID
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 15: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,888 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 15 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,889 - root - WARNING - parser.extract_id_from_block:123 - Block 16: No ID found using any method
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:160 - Block 16: Failed to extract ID
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 16: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 16 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,889 - root - WARNING - parser.extract_id_from_block:123 - Block 17: No ID found using any method
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:160 - Block 17: Failed to extract ID
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 17: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 17 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,889 - root - WARNING - parser.extract_id_from_block:123 - Block 18: No ID found using any method
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:160 - Block 18: Failed to extract ID
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 18: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 18 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,889 - root - WARNING - parser.extract_id_from_block:123 - Block 19: No ID found using any method
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:160 - Block 19: Failed to extract ID
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 19: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,889 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 19 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,890 - root - WARNING - parser.extract_id_from_block:123 - Block 20: No ID found using any method
2025-05-13 16:19:43,890 - root - WARNING - parser.parse_wipo_html:160 - Block 20: Failed to extract ID
2025-05-13 16:19:43,890 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 20: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,890 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 20 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,890 - root - WARNING - parser.extract_id_from_block:123 - Block 21: No ID found using any method
2025-05-13 16:19:43,890 - root - WARNING - parser.parse_wipo_html:160 - Block 21: Failed to extract ID
2025-05-13 16:19:43,890 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 21: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,890 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 21 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,890 - root - WARNING - parser.extract_id_from_block:123 - Block 22: No ID found using any method
2025-05-13 16:19:43,890 - root - WARNING - parser.parse_wipo_html:160 - Block 22: Failed to extract ID
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 22: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 22 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,891 - root - WARNING - parser.extract_id_from_block:123 - Block 23: No ID found using any method
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:160 - Block 23: Failed to extract ID
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 23: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 23 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,891 - root - WARNING - parser.extract_id_from_block:123 - Block 24: No ID found using any method
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:160 - Block 24: Failed to extract ID
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 24: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,891 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 24 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,892 - root - WARNING - parser.extract_id_from_block:123 - Block 25: No ID found using any method
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:160 - Block 25: Failed to extract ID
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 25: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 25 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,892 - root - WARNING - parser.extract_id_from_block:123 - Block 26: No ID found using any method
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:160 - Block 26: Failed to extract ID
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 26: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 26 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,892 - root - WARNING - parser.extract_id_from_block:123 - Block 27: No ID found using any method
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:160 - Block 27: Failed to extract ID
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 27: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 27 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,892 - root - WARNING - parser.extract_id_from_block:123 - Block 28: No ID found using any method
2025-05-13 16:19:43,892 - root - WARNING - parser.parse_wipo_html:160 - Block 28: Failed to extract ID
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 28: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 28 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,893 - root - WARNING - parser.extract_id_from_block:123 - Block 29: No ID found using any method
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:160 - Block 29: Failed to extract ID
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 29: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 29 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,893 - root - WARNING - parser.extract_id_from_block:123 - Block 30: No ID found using any method
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:160 - Block 30: Failed to extract ID
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 30: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:19:43,893 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 30 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:19:43,893 - root - INFO - parser.parse_wipo_html:217 - Parser: Successfully parsed 5 items from 30 blocks.
2025-05-13 16:19:43,914 - root - ERROR - wipo._save_wipo_items_to_db:135 - DB Save (WIPO_Search_RONALDO): Error processing/merging item (ID: M1935158, Name: RONALDO). Rolled back for this item. Error: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 127, in _save_wipo_items_to_db
    db_session.merge(brand_instance)  # Sử dụng merge để insert hoặc update
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3960, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4045, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3694, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3874, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "M1935158"
LINE 3: WHERE trademark.id = 'M1935158'
                             ^

[SQL: SELECT trademark.id AS trademark_id, trademark.name AS trademark_name, trademark.product_group AS trademark_product_group, trademark.status AS trademark_status, trademark.registration_date AS trademark_registration_date, trademark.image_url AS trademark_image_url, trademark.source AS trademark_source, trademark.created_at AS trademark_created_at, trademark.owner AS trademark_owner, trademark.original_number AS trademark_original_number 
FROM trademark 
WHERE trademark.id = %(pk_1)s]
[parameters: {'pk_1': 'M1935158'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-05-13 16:19:43,918 - root - INFO - wipo._save_wipo_items_to_db:146 - DB Save (WIPO_Search_RONALDO): Successfully committed 4 out of 5 processed items to DB.
2025-05-13 16:19:43,918 - root - INFO - wipo.crawl_wipo_by_name:537 - WIPO Crawler: Successfully saved 5 items to database
2025-05-13 16:19:43,918 - root - INFO - wipo.crawl_wipo_by_name:543 - WIPO Crawler: Database session closed.
2025-05-13 16:19:43,918 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 16:19:43,918 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 16:23:05,926 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 16:23:05,926 - root - INFO - wipo.crawl_wipo_by_name:355 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 16:23:07,277 - root - INFO - wipo.crawl_wipo_by_name:385 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 16:23:19,814 - root - INFO - wipo.crawl_wipo_by_name:418 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 16:23:40,666 - root - INFO - wipo.crawl_wipo_by_name:457 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 16:23:40,666 - root - INFO - wipo.crawl_wipo_by_name:458 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 16:23:45,763 - root - INFO - wipo.crawl_wipo_by_name:509 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 16:23:45,763 - root - INFO - wipo.crawl_wipo_by_name:519 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 16:23:45,775 - root - INFO - parser.parse_wipo_html:136 - Found 30 result blocks to parse
2025-05-13 16:23:45,776 - root - INFO - parser.extract_id_from_block:101 - Block 1: Successfully extracted ID '812888227' using selector '.number span.value'
2025-05-13 16:23:45,776 - root - INFO - parser.parse_wipo_html:158 - Block 1: Using ID '812888227' (found with selector: .number span.value)
2025-05-13 16:23:45,777 - root - INFO - parser.extract_id_from_block:101 - Block 2: Successfully extracted ID '545892' using selector '.number span.value'
2025-05-13 16:23:45,777 - root - INFO - parser.parse_wipo_html:158 - Block 2: Using ID '545892' (found with selector: .number span.value)
2025-05-13 16:23:45,779 - root - INFO - parser.extract_id_from_block:101 - Block 3: Successfully extracted ID '544244' using selector '.number span.value'
2025-05-13 16:23:45,779 - root - INFO - parser.parse_wipo_html:158 - Block 3: Using ID '544244' (found with selector: .number span.value)
2025-05-13 16:23:45,780 - root - INFO - parser.extract_id_from_block:101 - Block 4: Successfully extracted ID '145299' using selector '.number span.value'
2025-05-13 16:23:45,780 - root - INFO - parser.parse_wipo_html:158 - Block 4: Using ID '145299' (found with selector: .number span.value)
2025-05-13 16:23:45,781 - root - INFO - parser.extract_id_from_block:101 - Block 5: Successfully extracted ID 'M1935158' using selector '.number span.value'
2025-05-13 16:23:45,781 - root - INFO - parser.parse_wipo_html:158 - Block 5: Using ID 'M1935158' (found with selector: .number span.value)
2025-05-13 16:23:45,783 - root - WARNING - parser.extract_id_from_block:123 - Block 6: No ID found using any method
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:160 - Block 6: Failed to extract ID
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 6: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 6 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,783 - root - WARNING - parser.extract_id_from_block:123 - Block 7: No ID found using any method
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:160 - Block 7: Failed to extract ID
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 7: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 7 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,783 - root - WARNING - parser.extract_id_from_block:123 - Block 8: No ID found using any method
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:160 - Block 8: Failed to extract ID
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 8: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,783 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 8 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,784 - root - WARNING - parser.extract_id_from_block:123 - Block 9: No ID found using any method
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:160 - Block 9: Failed to extract ID
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 9: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 9 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,784 - root - WARNING - parser.extract_id_from_block:123 - Block 10: No ID found using any method
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:160 - Block 10: Failed to extract ID
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 10: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 10 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,784 - root - WARNING - parser.extract_id_from_block:123 - Block 11: No ID found using any method
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:160 - Block 11: Failed to extract ID
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 11: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 11 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,784 - root - WARNING - parser.extract_id_from_block:123 - Block 12: No ID found using any method
2025-05-13 16:23:45,784 - root - WARNING - parser.parse_wipo_html:160 - Block 12: Failed to extract ID
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 12: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 12 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,785 - root - WARNING - parser.extract_id_from_block:123 - Block 13: No ID found using any method
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:160 - Block 13: Failed to extract ID
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 13: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 13 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,785 - root - WARNING - parser.extract_id_from_block:123 - Block 14: No ID found using any method
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:160 - Block 14: Failed to extract ID
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 14: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 14 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,785 - root - WARNING - parser.extract_id_from_block:123 - Block 15: No ID found using any method
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:160 - Block 15: Failed to extract ID
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 15: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,785 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 15 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,786 - root - WARNING - parser.extract_id_from_block:123 - Block 16: No ID found using any method
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:160 - Block 16: Failed to extract ID
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 16: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 16 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,786 - root - WARNING - parser.extract_id_from_block:123 - Block 17: No ID found using any method
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:160 - Block 17: Failed to extract ID
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 17: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 17 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,786 - root - WARNING - parser.extract_id_from_block:123 - Block 18: No ID found using any method
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:160 - Block 18: Failed to extract ID
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 18: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,786 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 18 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,787 - root - WARNING - parser.extract_id_from_block:123 - Block 19: No ID found using any method
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:160 - Block 19: Failed to extract ID
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 19: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 19 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,787 - root - WARNING - parser.extract_id_from_block:123 - Block 20: No ID found using any method
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:160 - Block 20: Failed to extract ID
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 20: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 20 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,787 - root - WARNING - parser.extract_id_from_block:123 - Block 21: No ID found using any method
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:160 - Block 21: Failed to extract ID
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 21: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,787 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 21 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,787 - root - WARNING - parser.extract_id_from_block:123 - Block 22: No ID found using any method
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:160 - Block 22: Failed to extract ID
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 22: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 22 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,788 - root - WARNING - parser.extract_id_from_block:123 - Block 23: No ID found using any method
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:160 - Block 23: Failed to extract ID
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 23: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 23 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,788 - root - WARNING - parser.extract_id_from_block:123 - Block 24: No ID found using any method
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:160 - Block 24: Failed to extract ID
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 24: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 24 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,788 - root - WARNING - parser.extract_id_from_block:123 - Block 25: No ID found using any method
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:160 - Block 25: Failed to extract ID
2025-05-13 16:23:45,788 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 25: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 25 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,789 - root - WARNING - parser.extract_id_from_block:123 - Block 26: No ID found using any method
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:160 - Block 26: Failed to extract ID
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 26: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 26 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,789 - root - WARNING - parser.extract_id_from_block:123 - Block 27: No ID found using any method
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:160 - Block 27: Failed to extract ID
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 27: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 27 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,789 - root - WARNING - parser.extract_id_from_block:123 - Block 28: No ID found using any method
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:160 - Block 28: Failed to extract ID
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 28: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,789 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 28 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,790 - root - WARNING - parser.extract_id_from_block:123 - Block 29: No ID found using any method
2025-05-13 16:23:45,790 - root - WARNING - parser.parse_wipo_html:160 - Block 29: Failed to extract ID
2025-05-13 16:23:45,790 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 29: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,790 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 29 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,790 - root - WARNING - parser.extract_id_from_block:123 - Block 30: No ID found using any method
2025-05-13 16:23:45,790 - root - WARNING - parser.parse_wipo_html:160 - Block 30: Failed to extract ID
2025-05-13 16:23:45,790 - root - WARNING - parser.parse_wipo_html:193 - Parser: Block 30: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:23:45,790 - root - WARNING - parser.parse_wipo_html:202 - Parser: Skipping item for block 30 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:23:45,790 - root - INFO - parser.parse_wipo_html:217 - Parser: Successfully parsed 5 items from 30 blocks.
2025-05-13 16:23:45,815 - root - ERROR - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Error committing batch to DB: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "trademark_pkey"
DETAIL:  Key (id)=(812888227) already exists.

[SQL: INSERT INTO trademark (id, name, product_group, status, registration_date, image_url, source, owner, original_number) VALUES (%(id__0)s, %(name__0)s, %(product_group__0)s, %(status__0)s, %(registration_date__0)s, %(image_url__0)s, %(source__0)s, %(ow ... 618 characters truncated ... s, %(source__4)s, %(owner__4)s, %(original_number__4)s) RETURNING trademark.created_at, trademark.id]
[parameters: {'image_url__0': 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgr/2wBDAQ ... (14621 characters truncated) ... cYFJ9cc09ESNQiKAB0ApaKACiiigAooooAKKKKACoruys7+F7a9tY5o5EKPHKgZWUjBBB6gjtUtFAGb4Y8HeEvBOnf2P4N8L6dpNp5jyfZdMskgj3sdzNtQAZJOSe5rSoooAKKKKACiiigD//2Q==', 'product_group__0': None, 'source__0': 'WIPO_Search_RONALDO', 'registration_date__0': 'August 16, 1998', 'status__0': 'Expired', 'original_number__0': '812888227', 'id__0': '812888227', 'owner__0': 'RONALDO ADAI (Brazil)', 'name__0': 'RONALDO', 'image_url__1': None, 'product_group__1': '30', 'source__1': 'WIPO_Search_RONALDO', 'registration_date__1': 'July 30, 2012', 'status__1': 'Expired', 'original_number__1': '545892', 'id__1': '545892', 'owner__1': 'PT BINTANG ABADI PURI PERKASA (Indonesia)', 'name__1': 'RONALDO', 'image_url__2': None, 'product_group__2': '24', 'source__2': 'WIPO_Search_RONALDO', 'registration_date__2': 'July 17, 2012', 'status__2': 'Expired', 'original_number__2': '544244', 'id__2': '544244', 'owner__2': 'PT UNGGUL BUKIT KENCANA (Indonesia)', 'name__2': 'RONALDO', 'image_url__3': 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgr/2wBDAQ ... (14249 characters truncated) ... 3+aNamm02C5t5Ibmz3RyJtZa14gN05x2qRQMDgdKyshmRa2CW2k/2alm3k7dvzIvzf981e09EtrdYfJZtsXl7K1B/x5tUNMrmIVuYYV/fWfyr/cSnLeQzN8kLKv8AtVJRQSOV491Opqdfwp1AH//Z', 'product_group__3': '31, 29', 'source__3': 'WIPO_Search_RONALDO', 'registration_date__3': None, 'status__3': 'Unknown', 'original_number__3': '145299', 'id__3': '145299', 'owner__3': 'HZPC HOLLAND BV. (Netherlands)', 'name__3': 'RONALDO', 'image_url__4': None, 'product_group__4': '25', 'source__4': 'WIPO_Search_RONALDO', 'registration_date__4': 'February 5, 1996', 'status__4': 'Registered', 'original_number__4': 'M1935158', 'id__4': 'M1935158', 'owner__4': 'RONALDO LUIS NAZARIO DE LIMA (Spain)', 'name__4': 'RONALDO'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "trademark_pkey"
DETAIL:  Key (id)=(812888227) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/minhdangpy134/DuAnWipoVNmark/crawlers/wipo.py", line 145, in _save_wipo_items_to_db
    db_session.commit()
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/minhdangpy134/DuAnWipoVNmark/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "trademark_pkey"
DETAIL:  Key (id)=(812888227) already exists.

[SQL: INSERT INTO trademark (id, name, product_group, status, registration_date, image_url, source, owner, original_number) VALUES (%(id__0)s, %(name__0)s, %(product_group__0)s, %(status__0)s, %(registration_date__0)s, %(image_url__0)s, %(source__0)s, %(ow ... 618 characters truncated ... s, %(source__4)s, %(owner__4)s, %(original_number__4)s) RETURNING trademark.created_at, trademark.id]
[parameters: {'image_url__0': 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgr/2wBDAQ ... (14621 characters truncated) ... cYFJ9cc09ESNQiKAB0ApaKACiiigAooooAKKKKACoruys7+F7a9tY5o5EKPHKgZWUjBBB6gjtUtFAGb4Y8HeEvBOnf2P4N8L6dpNp5jyfZdMskgj3sdzNtQAZJOSe5rSoooAKKKKACiiigD//2Q==', 'product_group__0': None, 'source__0': 'WIPO_Search_RONALDO', 'registration_date__0': 'August 16, 1998', 'status__0': 'Expired', 'original_number__0': '812888227', 'id__0': '812888227', 'owner__0': 'RONALDO ADAI (Brazil)', 'name__0': 'RONALDO', 'image_url__1': None, 'product_group__1': '30', 'source__1': 'WIPO_Search_RONALDO', 'registration_date__1': 'July 30, 2012', 'status__1': 'Expired', 'original_number__1': '545892', 'id__1': '545892', 'owner__1': 'PT BINTANG ABADI PURI PERKASA (Indonesia)', 'name__1': 'RONALDO', 'image_url__2': None, 'product_group__2': '24', 'source__2': 'WIPO_Search_RONALDO', 'registration_date__2': 'July 17, 2012', 'status__2': 'Expired', 'original_number__2': '544244', 'id__2': '544244', 'owner__2': 'PT UNGGUL BUKIT KENCANA (Indonesia)', 'name__2': 'RONALDO', 'image_url__3': 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgr/2wBDAQ ... (14249 characters truncated) ... 3+aNamm02C5t5Ibmz3RyJtZa14gN05x2qRQMDgdKyshmRa2CW2k/2alm3k7dvzIvzf981e09EtrdYfJZtsXl7K1B/x5tUNMrmIVuYYV/fWfyr/cSnLeQzN8kLKv8AtVJRQSOV491Opqdfwp1AH//Z', 'product_group__3': '31, 29', 'source__3': 'WIPO_Search_RONALDO', 'registration_date__3': None, 'status__3': 'Unknown', 'original_number__3': '145299', 'id__3': '145299', 'owner__3': 'HZPC HOLLAND BV. (Netherlands)', 'name__3': 'RONALDO', 'image_url__4': None, 'product_group__4': '25', 'source__4': 'WIPO_Search_RONALDO', 'registration_date__4': 'February 5, 1996', 'status__4': 'Registered', 'original_number__4': 'M1935158', 'id__4': 'M1935158', 'owner__4': 'RONALDO LUIS NAZARIO DE LIMA (Spain)', 'name__4': 'RONALDO'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-13 16:23:45,819 - root - INFO - wipo._save_wipo_items_to_db:152 - DB Save (WIPO_Search_RONALDO): Rolled back changes after commit error.
2025-05-13 16:23:45,819 - root - INFO - wipo.crawl_wipo_by_name:537 - WIPO Crawler: Successfully saved 5 items to database
2025-05-13 16:23:45,819 - root - INFO - wipo.crawl_wipo_by_name:543 - WIPO Crawler: Database session closed.
2025-05-13 16:23:45,819 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 16:23:45,819 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
2025-05-13 16:31:46,196 - __main__ - INFO - test_manual.<module>:45 - Starting WIPO crawl application for brand: 'RONALDO'
2025-05-13 16:31:46,196 - root - INFO - wipo.crawl_wipo_by_name:360 - WIPO Crawler: Starting crawl for brand name: 'RONALDO'
2025-05-13 16:31:47,770 - root - INFO - wipo.crawl_wipo_by_name:390 - WIPO Crawler: Navigated to https://branddb.wipo.int/branddb/en/
2025-05-13 16:32:03,011 - root - INFO - wipo.crawl_wipo_by_name:423 - WIPO Crawler: Using dynamic timeout of 60 seconds
2025-05-13 16:32:23,460 - root - INFO - wipo.crawl_wipo_by_name:462 - WIPO Crawler: Found results using selector: div[class*='result']
2025-05-13 16:32:23,460 - root - INFO - wipo.crawl_wipo_by_name:463 - First result text: Brand name: contains the word 'RONALDO'and:Edit your searchTMviewSearch nameSave  Displaying 1-30 of...
2025-05-13 16:32:28,552 - root - INFO - wipo.crawl_wipo_by_name:514 - WIPO Crawler: Chrome driver quit successfully.
2025-05-13 16:32:28,552 - root - INFO - wipo.crawl_wipo_by_name:524 - WIPO Crawler: Parsing HTML for 'RONALDO'...
2025-05-13 16:32:28,566 - root - INFO - parser.parse_wipo_html:127 - Found 30 result blocks to parse
2025-05-13 16:32:28,567 - root - INFO - parser.extract_id_from_block:50 - Block 0: Starting ID extraction
2025-05-13 16:32:28,567 - root - INFO - parser.extract_id_from_block:75 - Block 0: Found ID '812888227' using selector '.number span.value'
2025-05-13 16:32:28,567 - root - INFO - parser.parse_wipo_html:149 - Block 1: Using ID '812888227' (found with selector: .number span.value)
2025-05-13 16:32:28,568 - root - INFO - parser.extract_id_from_block:50 - Block 1: Starting ID extraction
2025-05-13 16:32:28,569 - root - INFO - parser.extract_id_from_block:75 - Block 1: Found ID '545,892' using selector '.number span.value'
2025-05-13 16:32:28,569 - root - INFO - parser.parse_wipo_html:149 - Block 2: Using ID '545892' (found with selector: .number span.value)
2025-05-13 16:32:28,569 - root - INFO - parser.extract_id_from_block:50 - Block 2: Starting ID extraction
2025-05-13 16:32:28,570 - root - INFO - parser.extract_id_from_block:75 - Block 2: Found ID '544,244' using selector '.number span.value'
2025-05-13 16:32:28,570 - root - INFO - parser.parse_wipo_html:149 - Block 3: Using ID '544244' (found with selector: .number span.value)
2025-05-13 16:32:28,571 - root - INFO - parser.extract_id_from_block:50 - Block 3: Starting ID extraction
2025-05-13 16:32:28,571 - root - INFO - parser.extract_id_from_block:75 - Block 3: Found ID '145299' using selector '.number span.value'
2025-05-13 16:32:28,571 - root - INFO - parser.parse_wipo_html:149 - Block 4: Using ID '145299' (found with selector: .number span.value)
2025-05-13 16:32:28,572 - root - INFO - parser.extract_id_from_block:50 - Block 4: Starting ID extraction
2025-05-13 16:32:28,572 - root - INFO - parser.extract_id_from_block:75 - Block 4: Found ID 'M1935158' using selector '.number span.value'
2025-05-13 16:32:28,572 - root - INFO - parser.parse_wipo_html:149 - Block 5: Using ID 'M1935158' (found with selector: .number span.value)
2025-05-13 16:32:28,573 - root - INFO - parser.extract_id_from_block:50 - Block 5: Starting ID extraction
2025-05-13 16:32:28,574 - root - INFO - parser.extract_id_from_block:75 - Block 5: Found ID '4004598630000' using selector '.number span.value'
2025-05-13 16:32:28,574 - root - INFO - parser.parse_wipo_html:149 - Block 6: Using ID '4004598630000' (found with selector: .number span.value)
2025-05-13 16:32:28,574 - root - INFO - parser.extract_id_from_block:50 - Block 6: Starting ID extraction
2025-05-13 16:32:28,575 - root - INFO - parser.extract_id_from_block:75 - Block 6: Found ID 'VN-4-2009-23685' using selector '.number span.value'
2025-05-13 16:32:28,575 - root - INFO - parser.parse_wipo_html:149 - Block 7: Using ID 'VN-4-2009-23685' (found with selector: .number span.value)
2025-05-13 16:32:28,575 - root - INFO - parser.extract_id_from_block:50 - Block 7: Starting ID extraction
2025-05-13 16:32:28,576 - root - INFO - parser.extract_id_from_block:75 - Block 7: Found ID '2483811' using selector '.number span.value'
2025-05-13 16:32:28,576 - root - INFO - parser.parse_wipo_html:149 - Block 8: Using ID '2483811' (found with selector: .number span.value)
2025-05-13 16:32:28,576 - root - INFO - parser.extract_id_from_block:50 - Block 8: Starting ID extraction
2025-05-13 16:32:28,577 - root - INFO - parser.extract_id_from_block:75 - Block 8: Found ID '39818247' using selector '.number span.value'
2025-05-13 16:32:28,577 - root - INFO - parser.parse_wipo_html:149 - Block 9: Using ID '39818247' (found with selector: .number span.value)
2025-05-13 16:32:28,577 - root - INFO - parser.extract_id_from_block:50 - Block 9: Starting ID extraction
2025-05-13 16:32:28,578 - root - WARNING - parser.extract_id_from_block:114 - Block 9: No ID found using any method
2025-05-13 16:32:28,578 - root - WARNING - parser.parse_wipo_html:151 - Block 10: Failed to extract ID
2025-05-13 16:32:28,578 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 10: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,578 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 10 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,579 - root - INFO - parser.extract_id_from_block:50 - Block 10: Starting ID extraction
2025-05-13 16:32:28,579 - root - WARNING - parser.extract_id_from_block:114 - Block 10: No ID found using any method
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:151 - Block 11: Failed to extract ID
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 11: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 11 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,579 - root - INFO - parser.extract_id_from_block:50 - Block 11: Starting ID extraction
2025-05-13 16:32:28,579 - root - WARNING - parser.extract_id_from_block:114 - Block 11: No ID found using any method
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:151 - Block 12: Failed to extract ID
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 12: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 12 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,579 - root - INFO - parser.extract_id_from_block:50 - Block 12: Starting ID extraction
2025-05-13 16:32:28,579 - root - WARNING - parser.extract_id_from_block:114 - Block 12: No ID found using any method
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:151 - Block 13: Failed to extract ID
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 13: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,579 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 13 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,580 - root - INFO - parser.extract_id_from_block:50 - Block 13: Starting ID extraction
2025-05-13 16:32:28,580 - root - WARNING - parser.extract_id_from_block:114 - Block 13: No ID found using any method
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:151 - Block 14: Failed to extract ID
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 14: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 14 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,580 - root - INFO - parser.extract_id_from_block:50 - Block 14: Starting ID extraction
2025-05-13 16:32:28,580 - root - WARNING - parser.extract_id_from_block:114 - Block 14: No ID found using any method
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:151 - Block 15: Failed to extract ID
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 15: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 15 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,580 - root - INFO - parser.extract_id_from_block:50 - Block 15: Starting ID extraction
2025-05-13 16:32:28,580 - root - WARNING - parser.extract_id_from_block:114 - Block 15: No ID found using any method
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:151 - Block 16: Failed to extract ID
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 16: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,580 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 16 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,580 - root - INFO - parser.extract_id_from_block:50 - Block 16: Starting ID extraction
2025-05-13 16:32:28,581 - root - WARNING - parser.extract_id_from_block:114 - Block 16: No ID found using any method
2025-05-13 16:32:28,581 - root - WARNING - parser.parse_wipo_html:151 - Block 17: Failed to extract ID
2025-05-13 16:32:28,581 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 17: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,581 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 17 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,581 - root - INFO - parser.extract_id_from_block:50 - Block 17: Starting ID extraction
2025-05-13 16:32:28,581 - root - WARNING - parser.extract_id_from_block:114 - Block 17: No ID found using any method
2025-05-13 16:32:28,581 - root - WARNING - parser.parse_wipo_html:151 - Block 18: Failed to extract ID
2025-05-13 16:32:28,581 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 18: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,581 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 18 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,581 - root - INFO - parser.extract_id_from_block:50 - Block 18: Starting ID extraction
2025-05-13 16:32:28,581 - root - WARNING - parser.extract_id_from_block:114 - Block 18: No ID found using any method
2025-05-13 16:32:28,581 - root - WARNING - parser.parse_wipo_html:151 - Block 19: Failed to extract ID
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 19: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 19 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,582 - root - INFO - parser.extract_id_from_block:50 - Block 19: Starting ID extraction
2025-05-13 16:32:28,582 - root - WARNING - parser.extract_id_from_block:114 - Block 19: No ID found using any method
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:151 - Block 20: Failed to extract ID
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 20: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 20 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,582 - root - INFO - parser.extract_id_from_block:50 - Block 20: Starting ID extraction
2025-05-13 16:32:28,582 - root - WARNING - parser.extract_id_from_block:114 - Block 20: No ID found using any method
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:151 - Block 21: Failed to extract ID
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 21: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 21 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,582 - root - INFO - parser.extract_id_from_block:50 - Block 21: Starting ID extraction
2025-05-13 16:32:28,582 - root - WARNING - parser.extract_id_from_block:114 - Block 21: No ID found using any method
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:151 - Block 22: Failed to extract ID
2025-05-13 16:32:28,582 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 22: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 22 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,583 - root - INFO - parser.extract_id_from_block:50 - Block 22: Starting ID extraction
2025-05-13 16:32:28,583 - root - WARNING - parser.extract_id_from_block:114 - Block 22: No ID found using any method
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:151 - Block 23: Failed to extract ID
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 23: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 23 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,583 - root - INFO - parser.extract_id_from_block:50 - Block 23: Starting ID extraction
2025-05-13 16:32:28,583 - root - WARNING - parser.extract_id_from_block:114 - Block 23: No ID found using any method
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:151 - Block 24: Failed to extract ID
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 24: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 24 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,583 - root - INFO - parser.extract_id_from_block:50 - Block 24: Starting ID extraction
2025-05-13 16:32:28,583 - root - WARNING - parser.extract_id_from_block:114 - Block 24: No ID found using any method
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:151 - Block 25: Failed to extract ID
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 25: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,583 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 25 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,583 - root - INFO - parser.extract_id_from_block:50 - Block 25: Starting ID extraction
2025-05-13 16:32:28,584 - root - WARNING - parser.extract_id_from_block:114 - Block 25: No ID found using any method
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:151 - Block 26: Failed to extract ID
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 26: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 26 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,584 - root - INFO - parser.extract_id_from_block:50 - Block 26: Starting ID extraction
2025-05-13 16:32:28,584 - root - WARNING - parser.extract_id_from_block:114 - Block 26: No ID found using any method
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:151 - Block 27: Failed to extract ID
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 27: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 27 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,584 - root - INFO - parser.extract_id_from_block:50 - Block 27: Starting ID extraction
2025-05-13 16:32:28,584 - root - WARNING - parser.extract_id_from_block:114 - Block 27: No ID found using any method
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:151 - Block 28: Failed to extract ID
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 28: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,584 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 28 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,584 - root - INFO - parser.extract_id_from_block:50 - Block 28: Starting ID extraction
2025-05-13 16:32:28,585 - root - WARNING - parser.extract_id_from_block:114 - Block 28: No ID found using any method
2025-05-13 16:32:28,585 - root - WARNING - parser.parse_wipo_html:151 - Block 29: Failed to extract ID
2025-05-13 16:32:28,585 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 29: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,585 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 29 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,585 - root - INFO - parser.extract_id_from_block:50 - Block 29: Starting ID extraction
2025-05-13 16:32:28,585 - root - WARNING - parser.extract_id_from_block:114 - Block 29: No ID found using any method
2025-05-13 16:32:28,585 - root - WARNING - parser.parse_wipo_html:151 - Block 30: Failed to extract ID
2025-05-13 16:32:28,585 - root - WARNING - parser.parse_wipo_html:184 - Parser: Block 30: 'application_or_registration_number' not found. Using fallback ID 'None_None'. This might not be unique.
2025-05-13 16:32:28,585 - root - WARNING - parser.parse_wipo_html:193 - Parser: Skipping item for block 30 due to missing critical data (ID or Name). ID: None_None, Name: None
2025-05-13 16:32:28,585 - root - INFO - parser.parse_wipo_html:208 - Parser: Successfully parsed 9 items from 30 blocks.
2025-05-13 16:32:28,590 - root - INFO - wipo._save_wipo_items_to_db:121 - DB Save (WIPO_Search_RONALDO): Updating existing record for ID: 812888227
2025-05-13 16:32:28,598 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item 812888227
2025-05-13 16:32:28,599 - root - INFO - wipo._save_wipo_items_to_db:121 - DB Save (WIPO_Search_RONALDO): Updating existing record for ID: 545892
2025-05-13 16:32:28,600 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item 545892
2025-05-13 16:32:28,600 - root - INFO - wipo._save_wipo_items_to_db:121 - DB Save (WIPO_Search_RONALDO): Updating existing record for ID: 544244
2025-05-13 16:32:28,601 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item 544244
2025-05-13 16:32:28,601 - root - INFO - wipo._save_wipo_items_to_db:121 - DB Save (WIPO_Search_RONALDO): Updating existing record for ID: 145299
2025-05-13 16:32:28,602 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item 145299
2025-05-13 16:32:28,602 - root - INFO - wipo._save_wipo_items_to_db:121 - DB Save (WIPO_Search_RONALDO): Updating existing record for ID: M1935158
2025-05-13 16:32:28,603 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item M1935158
2025-05-13 16:32:28,603 - root - INFO - wipo._save_wipo_items_to_db:130 - DB Save (WIPO_Search_RONALDO): Adding new record for ID: 4004598630000
2025-05-13 16:32:28,605 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item 4004598630000
2025-05-13 16:32:28,606 - root - INFO - wipo._save_wipo_items_to_db:130 - DB Save (WIPO_Search_RONALDO): Adding new record for ID: VN-4-2009-23685
2025-05-13 16:32:28,607 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item VN-4-2009-23685
2025-05-13 16:32:28,608 - root - INFO - wipo._save_wipo_items_to_db:130 - DB Save (WIPO_Search_RONALDO): Adding new record for ID: 2483811
2025-05-13 16:32:28,609 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item 2483811
2025-05-13 16:32:28,610 - root - INFO - wipo._save_wipo_items_to_db:130 - DB Save (WIPO_Search_RONALDO): Adding new record for ID: 39818247
2025-05-13 16:32:28,611 - root - INFO - wipo._save_wipo_items_to_db:149 - DB Save (WIPO_Search_RONALDO): Successfully saved item 39818247
2025-05-13 16:32:28,611 - root - INFO - wipo._save_wipo_items_to_db:158 - DB Save (WIPO_Search_RONALDO): Processing complete. Processed: 9, Saved: 9, Skipped: 0, Errors: 0
2025-05-13 16:32:28,611 - root - INFO - wipo.crawl_wipo_by_name:542 - WIPO Crawler: Successfully saved 9 items to database
2025-05-13 16:32:28,611 - root - INFO - wipo.crawl_wipo_by_name:548 - WIPO Crawler: Database session closed.
2025-05-13 16:32:28,611 - __main__ - INFO - test_manual.<module>:48 - WIPO crawl application finished for brand: 'RONALDO'
2025-05-13 16:32:28,611 - __main__ - INFO - test_manual.<module>:53 - WIPO crawl application is shutting down.
